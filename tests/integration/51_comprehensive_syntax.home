// Comprehensive Syntax Test Suite
// Tests the core TypeScript-like features that are currently supported

// ============================================
// Test 1: Variable declarations
// ============================================
fn test_variables(): i32 {
    let x = 42;
    let y = x + 10;
    let mut z = 0;
    z = z + 1;
    z = z + 1;

    if (x != 42) { return 1; }
    if (y != 52) { return 2; }
    if (z != 2) { return 3; }

    return 0;
}

// ============================================
// Test 2: Arithmetic operations
// ============================================
fn test_arithmetic(): i32 {
    let a = 10;
    let b = 3;

    let sum = a + b;
    let diff = a - b;
    let prod = a * b;
    let quot = a / b;
    let rem = a % b;

    if (sum != 13) { return 1; }
    if (diff != 7) { return 2; }
    if (prod != 30) { return 3; }
    if (quot != 3) { return 4; }
    if (rem != 1) { return 5; }

    return 0;
}

// ============================================
// Test 3: Comparison operators
// ============================================
fn test_comparisons(): i32 {
    let a = 10;
    let b = 20;

    if ((a < b) != true) { return 1; }
    if ((a > b) != false) { return 2; }
    if ((a == 10) != true) { return 3; }
    if ((a != b) != true) { return 4; }
    if ((a <= 10) != true) { return 5; }
    if ((b >= 20) != true) { return 6; }

    return 0;
}

// ============================================
// Test 4: Logical operators
// ============================================
fn test_logical(): i32 {
    let t = true;
    let f = false;

    if ((t and t) != true) { return 1; }
    if ((t and f) != false) { return 2; }
    if ((t or f) != true) { return 3; }
    if ((f or f) != false) { return 4; }
    if ((!t) != false) { return 5; }
    if ((!f) != true) { return 6; }

    return 0;
}

// ============================================
// Test 5: Control flow - if/else
// ============================================
fn test_if_else(): i32 {
    let x = 10;
    let mut result = 0;

    if (x > 5) {
        result = 1;
    } else {
        result = 2;
    }
    if (result != 1) { return 1; }

    if (x < 5) {
        result = 3;
    } else if (x < 15) {
        result = 4;
    } else {
        result = 5;
    }
    if (result != 4) { return 2; }

    return 0;
}

// ============================================
// Test 6: Control flow - while loops
// ============================================
fn test_while(): i32 {
    let mut sum = 0;
    let mut i = 0;

    while (i < 10) {
        sum = sum + i;
        i = i + 1;
    }

    if (sum != 45) { return 1; }
    if (i != 10) { return 2; }

    return 0;
}

// ============================================
// Test 7: Functions with parameters
// ============================================
fn add(a: i32, b: i32): i32 {
    return a + b;
}

fn multiply(a: i32, b: i32): i32 {
    return a * b;
}

fn test_functions(): i32 {
    let r1 = add(5, 3);
    let r2 = multiply(4, 7);
    let r3 = add(r1, r2);

    if (r1 != 8) { return 1; }
    if (r2 != 28) { return 2; }
    if (r3 != 36) { return 3; }

    return 0;
}

// ============================================
// Test 8: Recursive functions
// ============================================
fn factorial(n: i32): i32 {
    if (n <= 1) {
        return 1;
    }
    return n * factorial(n - 1);
}

fn fibonacci(n: i32): i32 {
    if (n <= 0) { return 0; }
    if (n == 1) { return 1; }
    return fibonacci(n - 1) + fibonacci(n - 2);
}

fn test_recursion(): i32 {
    let f5 = factorial(5);
    if (f5 != 120) { return 1; }

    let fib6 = fibonacci(6);
    if (fib6 != 8) { return 2; }

    return 0;
}

// ============================================
// Test 9: Arrays
// ============================================
fn test_arrays(): i32 {
    let arr = [1, 2, 3, 4, 5];

    if (arr[0] != 1) { return 1; }
    if (arr[4] != 5) { return 2; }

    // Array sum
    let mut sum = 0;
    let mut i = 0;
    while (i < 5) {
        sum = sum + arr[i];
        i = i + 1;
    }
    if (sum != 15) { return 3; }

    return 0;
}

// ============================================
// Test 10: Strings
// ============================================
fn test_strings(): i32 {
    let s1 = "Hello";
    let s2 = "World";
    let combined = s1 + ", " + s2 + "!";

    if (s1 != "Hello") { return 1; }
    if (combined != "Hello, World!") { return 2; }

    return 0;
}

// ============================================
// Test 11: Structs
// ============================================
struct Point {
    x: i32,
    y: i32
}

fn test_structs(): i32 {
    let p = Point { x: 10, y: 20 };

    if (p.x != 10) { return 1; }
    if (p.y != 20) { return 2; }

    let sum = p.x + p.y;
    if (sum != 30) { return 3; }

    return 0;
}

// ============================================
// Test 12: Conditional helper functions
// ============================================
fn max_val(a: i32, b: i32): i32 {
    if (a > b) {
        return a;
    }
    return b;
}

fn min_val(a: i32, b: i32): i32 {
    if (a < b) {
        return a;
    }
    return b;
}

fn test_conditionals(): i32 {
    let a = 10;
    let b = 20;

    let max = max_val(a, b);
    if (max != 20) { return 1; }

    let min = min_val(a, b);
    if (min != 10) { return 2; }

    return 0;
}

// ============================================
// Test 13: Bitwise operators
// ============================================
fn test_bitwise(): i32 {
    let a = 0b1010;
    let b = 0b1100;

    let and_result = a & b;
    if (and_result != 8) { return 1; }

    let or_result = a | b;
    if (or_result != 14) { return 2; }

    let xor_result = a ^ b;
    if (xor_result != 6) { return 3; }

    let lshift = a << 2;
    if (lshift != 40) { return 4; }

    let rshift = a >> 1;
    if (rshift != 5) { return 5; }

    return 0;
}

// ============================================
// Test 14: Nested control flow
// ============================================
fn test_nested_control(): i32 {
    let mut total = 0;
    let mut i = 0;

    while (i < 3) {
        let mut j = 0;
        while (j < 3) {
            total = total + 1;
            j = j + 1;
        }
        i = i + 1;
    }

    if (total != 9) { return 1; }
    return 0;
}

// ============================================
// Test 15: Function composition
// ============================================
fn double(x: i32): i32 {
    return x * 2;
}

fn increment(x: i32): i32 {
    return x + 1;
}

fn test_composition(): i32 {
    let x = 5;
    let r1 = double(increment(x));  // (5 + 1) * 2 = 12
    let r2 = increment(double(x));  // (5 * 2) + 1 = 11

    if (r1 != 12) { return 1; }
    if (r2 != 11) { return 2; }

    return 0;
}

// ============================================
// Test 16: Complex expressions
// ============================================
fn categorize(x: i32): i32 {
    if (x < 0) {
        return 0 - 1;
    } else if (x == 0) {
        return 0;
    } else {
        return 1;
    }
}

fn test_complex_expressions(): i32 {
    let a = 2;
    let b = 3;
    let c = 4;

    // Test operator precedence
    let r1 = a + b * c;  // 2 + 12 = 14
    if (r1 != 14) { return 1; }

    let r2 = (a + b) * c;  // 5 * 4 = 20
    if (r2 != 20) { return 2; }

    // Categorization
    let x = 5;
    let category = categorize(x);
    if (category != 1) { return 3; }

    return 0;
}

// ============================================
// Main test runner
// ============================================
fn main(): i32 {
    let t1 = test_variables();
    if (t1 != 0) { print("test_variables failed\n"); return 1; }

    let t2 = test_arithmetic();
    if (t2 != 0) { print("test_arithmetic failed\n"); return 2; }

    let t3 = test_comparisons();
    if (t3 != 0) { print("test_comparisons failed\n"); return 3; }

    let t4 = test_logical();
    if (t4 != 0) { print("test_logical failed\n"); return 4; }

    let t5 = test_if_else();
    if (t5 != 0) { print("test_if_else failed\n"); return 5; }

    let t6 = test_while();
    if (t6 != 0) { print("test_while failed\n"); return 6; }

    let t7 = test_functions();
    if (t7 != 0) { print("test_functions failed\n"); return 7; }

    let t8 = test_recursion();
    if (t8 != 0) { print("test_recursion failed\n"); return 8; }

    let t9 = test_arrays();
    if (t9 != 0) { print("test_arrays failed\n"); return 9; }

    let t10 = test_strings();
    if (t10 != 0) { print("test_strings failed\n"); return 10; }

    let t11 = test_structs();
    if (t11 != 0) { print("test_structs failed\n"); return 11; }

    let t12 = test_conditionals();
    if (t12 != 0) { print("test_conditionals failed\n"); return 12; }

    let t13 = test_bitwise();
    if (t13 != 0) { print("test_bitwise failed\n"); return 13; }

    let t14 = test_nested_control();
    if (t14 != 0) { print("test_nested_control failed\n"); return 14; }

    let t15 = test_composition();
    if (t15 != 0) { print("test_composition failed\n"); return 15; }

    let t16 = test_complex_expressions();
    if (t16 != 0) { print("test_complex_expressions failed\n"); return 16; }

    print("All 16 comprehensive syntax tests passed!\n");
    return 0;
}
