// If Expressions Test Suite
// Tests if/else as expressions that return values

it("should return value from if expression") {
    let x = 10;
    let result = if (x > 5) { 100 } else { 0 };
    assert(result == 100);
}

it("should return else value when condition false") {
    let x = 3;
    let result = if (x > 5) { 100 } else { 0 };
    assert(result == 0);
}

it("should work with else if chains") {
    let x = 50;
    let result = if (x < 0) { -1 }
                 else if (x == 0) { 0 }
                 else if (x < 10) { 1 }
                 else if (x < 100) { 2 }
                 else { 3 };
    assert(result == 2);
}

it("should assign to variable directly") {
    let a = 7;
    let sign = if (a > 0) { 1 } else if (a < 0) { -1 } else { 0 };
    assert(sign == 1);
}

it("should work with string results") {
    let age = 25;
    let category = if (age < 18) { "minor" } else { "adult" };
    assert(category == "adult");
}

it("should nest if expressions") {
    let x = 10;
    let y = 5;
    let result = if (x > 0) {
        if (y > 0) { "both positive" } else { "x positive" }
    } else {
        "x not positive"
    };
    assert(result == "both positive");
}

it("should use in function return") {
    fn classify(n: i32): string {
        return if (n < 0) { "negative" }
               else if (n == 0) { "zero" }
               else { "positive" };
    }
    assert(classify(-5) == "negative");
    assert(classify(0) == "zero");
    assert(classify(5) == "positive");
}

it("should work in arithmetic") {
    let x = 3;
    let bonus = if (x > 5) { 100 } else { 50 };
    let total = x * 10 + bonus;
    assert(total == 80);
}

it("should handle complex conditions") {
    let a = 5;
    let b = 10;
    let result = if (a > 0 && b > a) { a + b } else { 0 };
    assert(result == 15);
}

it("should work with comparisons inside") {
    let score = 85;
    let grade = if (score >= 90) { 4 }
                else if (score >= 80) { 3 }
                else if (score >= 70) { 2 }
                else if (score >= 60) { 1 }
                else { 0 };
    assert(grade == 3);
}

// ============================================================================
// EDGE CASES - BOOLEAN CONDITIONS
// ============================================================================

it("should handle true literal condition") {
    let result = if (true) { 1 } else { 0 };
    assert(result == 1);
}

it("should handle false literal condition") {
    let result = if (false) { 1 } else { 0 };
    assert(result == 0);
}

it("should handle boolean variable condition") {
    let flag = true;
    let result = if (flag) { 100 } else { 0 };
    assert(result == 100);
}

it("should handle negated condition") {
    let flag = false;
    let result = if (!flag) { 1 } else { 0 };
    assert(result == 1);
}

// ============================================================================
// EDGE CASES - NUMERIC COMPARISONS
// ============================================================================

it("should handle zero comparison") {
    let x = 0;
    let result = if (x == 0) { "zero" } else { "nonzero" };
    assert(result == "zero");
}

it("should handle negative comparison") {
    let x = -5;
    let result = if (x < 0) { "negative" } else { "non-negative" };
    assert(result == "negative");
}

it("should handle equality at boundary") {
    let x = 10;
    let result = if (x >= 10) { "pass" } else { "fail" };
    assert(result == "pass");
}

it("should handle strict inequality") {
    let x = 10;
    let result = if (x > 10) { "greater" } else { "not greater" };
    assert(result == "not greater");
}

// ============================================================================
// EDGE CASES - COMPOUND CONDITIONS
// ============================================================================

it("should handle and condition both true") {
    let a = 5;
    let b = 10;
    let result = if (a > 0 and b > 0) { 1 } else { 0 };
    assert(result == 1);
}

it("should handle and condition one false") {
    let a = -5;
    let b = 10;
    let result = if (a > 0 and b > 0) { 1 } else { 0 };
    assert(result == 0);
}

it("should handle or condition") {
    let a = -5;
    let b = 10;
    let result = if (a > 0 or b > 0) { 1 } else { 0 };
    assert(result == 1);
}

it("should handle or condition both false") {
    let a = -5;
    let b = -10;
    let result = if (a > 0 or b > 0) { 1 } else { 0 };
    assert(result == 0);
}

// ============================================================================
// EDGE CASES - NESTED IF EXPRESSIONS
// ============================================================================

it("should handle deeply nested if expressions") {
    let x = 3;
    let result = if (x > 0) {
        if (x > 2) {
            if (x > 4) { "large" } else { "medium" }
        } else { "small" }
    } else { "negative" };
    assert(result == "medium");
}

it("should handle nested in else branch") {
    let x = -5;
    let y = 10;
    let result = if (x > 0) { "x positive" }
                 else { if (y > 0) { "y positive" } else { "both negative" } };
    assert(result == "y positive");
}

// ============================================================================
// EDGE CASES - IF EXPRESSION RESULTS
// ============================================================================

it("should return zero from if expression") {
    let x = 5;
    let result = if (x < 0) { 1 } else { 0 };
    assert(result == 0);
}

it("should return negative from if expression") {
    let x = 5;
    let result = if (x > 0) { -1 } else { 1 };
    assert(result == -1);
}

it("should return computed value") {
    let x = 5;
    let result = if (x > 0) { x * 2 } else { x };
    assert(result == 10);
}

// ============================================================================
// EDGE CASES - IF EXPRESSION WITH STRINGS
// ============================================================================

it("should return empty string") {
    let flag = false;
    let result = if (flag) { "yes" } else { "" };
    assert(result == "");
}

it("should return string based on length") {
    let s = "hello";
    let result = if (s.len() > 3) { "long" } else { "short" };
    assert(result == "long");
}

// ============================================================================
// EDGE CASES - IF EXPRESSION IN OPERATIONS
// ============================================================================

it("should use if expression in addition") {
    let x = 5;
    let result = 10 + if (x > 0) { 5 } else { 0 };
    assert(result == 15);
}

it("should use if expression in multiplication") {
    let x = 3;
    let result = x * if (x > 0) { 2 } else { 1 };
    assert(result == 6);
}

it("should use multiple if expressions") {
    let a = 5;
    let b = 3;
    let result = if (a > 0) { 10 } else { 0 } + if (b > 0) { 5 } else { 0 };
    assert(result == 15);
}

// ============================================================================
// EDGE CASES - IF EXPRESSION IN FUNCTION CALLS
// ============================================================================

it("should use if expression as function argument") {
    fn double(x: i32): i32 { return x * 2; }
    let flag = true;
    let result = double(if (flag) { 5 } else { 3 });
    assert(result == 10);
}

it("should use if expression in function body") {
    fn abs(x: i32): i32 {
        return if (x < 0) { 0 - x } else { x };
    }
    assert(abs(5) == 5);
    assert(abs(-5) == 5);
    assert(abs(0) == 0);
}

it("should use if expression for sign") {
    fn sign(x: i32): i32 {
        return if (x > 0) { 1 } else if (x < 0) { -1 } else { 0 };
    }
    assert(sign(10) == 1);
    assert(sign(-10) == -1);
    assert(sign(0) == 0);
}

// ============================================================================
// EDGE CASES - ELSE IF CHAINS
// ============================================================================

it("should handle long else if chain") {
    let x = 42;
    let result = if (x == 1) { "one" }
                 else if (x == 2) { "two" }
                 else if (x == 3) { "three" }
                 else if (x == 4) { "four" }
                 else if (x == 5) { "five" }
                 else { "other" };
    assert(result == "other");
}

it("should match first condition in chain") {
    let x = 50;
    let result = if (x > 10) { 1 }
                 else if (x > 20) { 2 }
                 else if (x > 30) { 3 }
                 else { 0 };
    assert(result == 1);
}

it("should handle else if with ranges") {
    fn categorize(n: i32): string {
        return if (n < 0) { "negative" }
               else if (n < 10) { "single digit" }
               else if (n < 100) { "two digits" }
               else if (n < 1000) { "three digits" }
               else { "large" };
    }
    assert(categorize(-5) == "negative");
    assert(categorize(5) == "single digit");
    assert(categorize(50) == "two digits");
    assert(categorize(500) == "three digits");
    assert(categorize(5000) == "large");
}

// ============================================================================
// EDGE CASES - IF EXPRESSION WITH ARRAYS
// ============================================================================

it("should select array based on condition") {
    let flag = true;
    let arr = if (flag) { [1, 2, 3] } else { [4, 5, 6] };
    assert(arr[0] == 1);
}

it("should use if expression for array index") {
    let arr = [10, 20, 30];
    let flag = true;
    let index = if (flag) { 0 } else { 2 };
    assert(arr[index] == 10);
}

// ============================================================================
// EDGE CASES - IF EXPRESSION WITH LOOPS
// ============================================================================

it("should use if expression in loop") {
    let mut sum = 0;
    for (i in 0..5) {
        sum = sum + if (i % 2 == 0) { i } else { 0 };
    }
    assert(sum == 6);  // 0 + 2 + 4
}

it("should use if expression to control loop variable") {
    let mut total = 0;
    let mut i = 0;
    while (i < 10) {
        let add = if (i < 5) { 1 } else { 2 };
        total = total + add;
        i = i + 1;
    }
    assert(total == 15);  // 5*1 + 5*2
}

