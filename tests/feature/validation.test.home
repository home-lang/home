// Validation Concepts Test Suite
// Testing validation concepts using basic operations

// ============================================================================
// STRING VALIDATION
// ============================================================================

it("should validate non-empty string") {
    let value = "hello";
    let is_valid = value.len() > 0 and value.trim().len() > 0;
    assert(is_valid == true);
}

it("should detect empty string") {
    let value = "";
    let is_empty = value.len() == 0;
    assert(is_empty == true);
}

it("should detect whitespace only") {
    let value = "   ";
    let trimmed = value.trim();
    let is_blank = trimmed.len() == 0;
    assert(is_blank == true);
}

it("should validate min length") {
    let value = "hello";
    let min_len = 3;
    let is_valid = value.len() >= min_len;
    assert(is_valid == true);
}

it("should reject below min length") {
    let value = "hi";
    let min_len = 3;
    let is_valid = value.len() >= min_len;
    assert(is_valid == false);
}

it("should validate max length") {
    let value = "hi";
    let max_len = 5;
    let is_valid = value.len() <= max_len;
    assert(is_valid == true);
}

it("should reject above max length") {
    let value = "hello world";
    let max_len = 5;
    let is_valid = value.len() <= max_len;
    assert(is_valid == false);
}

it("should validate length range") {
    let value = "hello";
    let min_len = 3;
    let max_len = 10;
    let is_valid = value.len() >= min_len and value.len() <= max_len;
    assert(is_valid == true);
}

// ============================================================================
// EMAIL VALIDATION CONCEPTS
// ============================================================================

it("should detect @ in email") {
    let email = "user@example.com";
    let has_at = email.contains("@");
    assert(has_at == true);
}

it("should detect domain in email") {
    let email = "user@example.com";
    let parts = email.split("@");
    assert(parts.len() == 2);
    assert(parts[1].contains("."));
}

it("should reject email without @") {
    let email = "invalid";
    let has_at = email.contains("@");
    assert(has_at == false);
}

it("should reject email without domain") {
    let email = "user@";
    let parts = email.split("@");
    let valid_domain = parts.len() == 2 and parts[1].len() > 0;
    assert(valid_domain == false);
}

// ============================================================================
// URL VALIDATION CONCEPTS
// ============================================================================

it("should detect URL scheme") {
    let url = "https://example.com";
    let has_scheme = url.starts_with("http://") or url.starts_with("https://");
    assert(has_scheme == true);
}

it("should detect https scheme") {
    let url = "https://example.com";
    let is_https = url.starts_with("https://");
    assert(is_https == true);
}

it("should reject URL without scheme") {
    let url = "example.com";
    let has_scheme = url.starts_with("http://") or url.starts_with("https://");
    assert(has_scheme == false);
}

// ============================================================================
// NUMERIC VALIDATION
// ============================================================================

it("should validate positive number") {
    let value = 5;
    let is_positive = value > 0;
    assert(is_positive == true);
}

it("should reject non-positive") {
    let value = 0;
    let is_positive = value > 0;
    assert(is_positive == false);
}

it("should validate non-negative") {
    let value = 0;
    let is_non_negative = value >= 0;
    assert(is_non_negative == true);
}

it("should validate integer range") {
    let value = 5;
    let min = 1;
    let max = 10;
    let in_range = value >= min and value <= max;
    assert(in_range == true);
}

it("should reject out of range") {
    let value = 15;
    let min = 1;
    let max = 10;
    let in_range = value >= min and value <= max;
    assert(in_range == false);
}

// ============================================================================
// DATE VALIDATION CONCEPTS
// ============================================================================

it("should validate ISO date format") {
    let date = "2023-12-25";
    let parts = date.split("-");
    let valid_format = parts.len() == 3;
    assert(valid_format == true);
}

it("should validate month range") {
    let month = 12;
    let valid = month >= 1 and month <= 12;
    assert(valid == true);
}

it("should reject invalid month") {
    let month = 13;
    let valid = month >= 1 and month <= 12;
    assert(valid == false);
}

it("should validate day range") {
    let day = 25;
    let valid = day >= 1 and day <= 31;
    assert(valid == true);
}

// ============================================================================
// TIME VALIDATION CONCEPTS
// ============================================================================

it("should validate time format") {
    let time = "14:30:00";
    let parts = time.split(":");
    let valid_format = parts.len() == 3;
    assert(valid_format == true);
}

it("should validate hour range") {
    let hour = 14;
    let valid = hour >= 0 and hour < 24;
    assert(valid == true);
}

it("should validate minute range") {
    let minute = 30;
    let valid = minute >= 0 and minute < 60;
    assert(valid == true);
}

// ============================================================================
// PATTERN VALIDATION
// ============================================================================

it("should detect alphanumeric") {
    let value = "abc123";
    let alphanumeric = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
    let mut is_valid = true;
    for (i in 0..value.len()) {
        if (!alphanumeric.contains(value.char_at(i))) {
            is_valid = false;
        }
    }
    assert(is_valid == true);
}

it("should reject non-alphanumeric") {
    let value = "abc-123";
    let has_hyphen = value.contains("-");
    assert(has_hyphen == true);
}

it("should validate slug format") {
    let slug = "hello-world";
    let valid_chars = "abcdefghijklmnopqrstuvwxyz0123456789-_";
    let mut is_valid = true;
    for (i in 0..slug.len()) {
        if (!valid_chars.contains(slug.char_at(i))) {
            is_valid = false;
        }
    }
    assert(is_valid == true);
}

// ============================================================================
// IP ADDRESS VALIDATION CONCEPTS
// ============================================================================

it("should validate IPv4 format") {
    let ip = "192.168.1.1";
    let parts = ip.split(".");
    assert(parts.len() == 4);
}

it("should validate IPv4 octet count") {
    let ip = "192.168.1";
    let parts = ip.split(".");
    let valid = parts.len() == 4;
    assert(valid == false);
}

// ============================================================================
// UUID VALIDATION CONCEPTS
// ============================================================================

it("should validate UUID length") {
    let uuid = "550e8400-e29b-41d4-a716-446655440000";
    assert(uuid.len() == 36);
}

it("should validate UUID dashes") {
    let uuid = "550e8400-e29b-41d4-a716-446655440000";
    let parts = uuid.split("-");
    assert(parts.len() == 5);
}

it("should validate UUID part lengths") {
    let uuid = "550e8400-e29b-41d4-a716-446655440000";
    let parts = uuid.split("-");
    assert(parts[0].len() == 8);
    assert(parts[1].len() == 4);
    assert(parts[2].len() == 4);
    assert(parts[3].len() == 4);
    assert(parts[4].len() == 12);
}

// ============================================================================
// FILE PATH VALIDATION
// ============================================================================

it("should validate absolute path") {
    let path = "/usr/local/bin";
    let is_absolute = path.starts_with("/");
    assert(is_absolute == true);
}

it("should detect relative path") {
    let path = "relative/path";
    let is_absolute = path.starts_with("/");
    assert(is_absolute == false);
}

it("should validate file extension") {
    let filename = "image.png";
    let valid_ext = filename.ends_with(".png") or filename.ends_with(".jpg") or filename.ends_with(".gif");
    assert(valid_ext == true);
}

// ============================================================================
// ARRAY VALIDATION
// ============================================================================

it("should validate array not empty") {
    let arr = [1, 2, 3];
    let is_valid = arr.len() > 0;
    assert(is_valid == true);
}

it("should validate array min length") {
    let arr = [1, 2, 3];
    let min_len = 2;
    let is_valid = arr.len() >= min_len;
    assert(is_valid == true);
}

it("should validate array max length") {
    let arr = [1, 2, 3];
    let max_len = 5;
    let is_valid = arr.len() <= max_len;
    assert(is_valid == true);
}

it("should check unique values") {
    let arr = [1, 2, 3];
    let mut has_duplicates = false;
    for (i in 0..arr.len()) {
        for (j in i + 1..arr.len()) {
            if (arr[i] == arr[j]) {
                has_duplicates = true;
            }
        }
    }
    assert(has_duplicates == false);
}

it("should detect duplicate values") {
    let arr = [1, 2, 2];
    let mut has_duplicates = false;
    for (i in 0..arr.len()) {
        for (j in i + 1..arr.len()) {
            if (arr[i] == arr[j]) {
                has_duplicates = true;
            }
        }
    }
    assert(has_duplicates == true);
}

// ============================================================================
// REQUIRED FIELDS
// ============================================================================

it("should check required field present") {
    let fields = ["name", "age", "email"];
    let required = "name";
    let mut found = false;
    for (f in fields) {
        if (f == required) {
            found = true;
        }
    }
    assert(found == true);
}

it("should detect missing required field") {
    let fields = ["name", "age"];
    let required = "email";
    let mut found = false;
    for (f in fields) {
        if (f == required) {
            found = true;
        }
    }
    assert(found == false);
}

// ============================================================================
// MULTIPLE ERRORS
// ============================================================================

it("should collect validation errors") {
    let mut errors = [];
    let value = "";

    if (value.len() == 0) {
        errors = errors.push("Value is required");
    }
    if (value.len() < 3) {
        errors = errors.push("Value must be at least 3 characters");
    }

    assert(errors.len() == 2);
}

it("should pass with no errors") {
    let mut errors = [];
    let value = "hello";

    if (value.len() == 0) {
        errors = errors.push("Value is required");
    }
    if (value.len() < 3) {
        errors = errors.push("Value must be at least 3 characters");
    }

    assert(errors.len() == 0);
}

// ============================================================================
// CHOICE VALIDATION
// ============================================================================

it("should validate value in choices") {
    let value = "info";
    let choices = ["debug", "info", "warn", "error"];
    let mut is_valid = false;
    for (c in choices) {
        if (c == value) {
            is_valid = true;
        }
    }
    assert(is_valid == true);
}

it("should reject invalid choice") {
    let value = "invalid";
    let choices = ["debug", "info", "warn", "error"];
    let mut is_valid = false;
    for (c in choices) {
        if (c == value) {
            is_valid = true;
        }
    }
    assert(is_valid == false);
}

