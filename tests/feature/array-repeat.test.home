// Array Repeat Syntax Test Suite
// Tests [value; count] array initialization

// ============================================================================
// BASIC ARRAY REPEAT
// ============================================================================

it("should create array with repeated value") {
    let arr = [0; 5];
    assert(arr.len() == 5);
    assert(arr[0] == 0);
    assert(arr[4] == 0);
}

it("should repeat non-zero value") {
    let arr = [42; 3];
    assert(arr.len() == 3);
    assert(arr[0] == 42);
    assert(arr[1] == 42);
    assert(arr[2] == 42);
}

it("should create single element array") {
    let arr = [100; 1];
    assert(arr.len() == 1);
    assert(arr[0] == 100);
}

// ============================================================================
// DIFFERENT TYPES
// ============================================================================

it("should repeat boolean values") {
    let arr = [true; 4];
    assert(arr.len() == 4);
    assert(arr[0] == true);
    assert(arr[3] == true);
}

it("should repeat string values") {
    let arr = ["hello"; 3];
    assert(arr.len() == 3);
    assert(arr[0] == "hello");
    assert(arr[2] == "hello");
}

it("should repeat float values") {
    let arr = [3.14; 2];
    assert(arr.len() == 2);
    assert(arr[0] == 3.14);
    assert(arr[1] == 3.14);
}

// ============================================================================
// REPEAT WITH EXPRESSIONS
// ============================================================================

it("should repeat computed value") {
    let x = 10;
    let arr = [x * 2; 3];
    assert(arr[0] == 20);
    assert(arr[1] == 20);
    assert(arr[2] == 20);
}

it("should repeat with computed count") {
    let count = 2 + 2;
    let arr = [1; count];
    assert(arr.len() == 4);
}

// ============================================================================
// OPERATIONS ON REPEATED ARRAYS
// ============================================================================

it("should sum repeated array") {
    let arr = [5; 4];
    let mut sum = 0;
    for (x in arr) {
        sum = sum + x;
    }
    assert(sum == 20);
}

it("should modify repeated array") {
    let mut arr = [0; 5];
    let mut i = 0;
    while (i < arr.len()) {
        arr[i] = i * 2;
        i = i + 1;
    }
    assert(arr[0] == 0);
    assert(arr[2] == 4);
    assert(arr[4] == 8);
}

// ============================================================================
// EDGE CASES
// ============================================================================

it("should create empty array with zero count") {
    let arr = [1; 0];
    assert(arr.len() == 0);
}

it("should handle large repeat count") {
    let arr = [1; 100];
    assert(arr.len() == 100);
    assert(arr[99] == 1);
}

// ============================================================================
// EDGE CASES - NEGATIVE VALUES
// ============================================================================

it("should repeat negative values") {
    let arr = [-5; 4];
    assert(arr.len() == 4);
    assert(arr[0] == -5);
    assert(arr[3] == -5);
}

it("should repeat negative one") {
    let arr = [-1; 3];
    assert(arr[0] == -1);
    assert(arr[1] == -1);
    assert(arr[2] == -1);
}

// ============================================================================
// EDGE CASES - SPECIAL VALUES
// ============================================================================

it("should repeat false boolean") {
    let arr = [false; 5];
    assert(arr.len() == 5);
    assert(arr[0] == false);
    assert(arr[4] == false);
}

it("should repeat empty string") {
    let arr = [""; 3];
    assert(arr.len() == 3);
    assert(arr[0] == "");
    assert(arr[2] == "");
}

it("should repeat special string") {
    let arr = ["hello world"; 2];
    assert(arr[0] == "hello world");
    assert(arr[1] == "hello world");
}

// ============================================================================
// EDGE CASES - WITH METHODS
// ============================================================================

it("should use sum on repeated array") {
    let arr = [10; 5];
    assert(arr.sum() == 50);
}

it("should use avg on repeated array") {
    let arr = [7; 3];
    assert(arr.avg() == 7);
}

it("should use first on repeated array") {
    let arr = [99; 10];
    assert(arr.first() == 99);
}

it("should use last on repeated array") {
    let arr = [99; 10];
    assert(arr.last() == 99);
}

it("should map repeated array") {
    let arr = [5; 3];
    let doubled = arr.map(|x| x * 2);
    assert(doubled[0] == 10);
    assert(doubled[1] == 10);
    assert(doubled[2] == 10);
}

it("should filter repeated array") {
    let arr = [5; 4];
    let filtered = arr.filter(|x| x > 4);
    assert(filtered.len() == 4);
}

// ============================================================================
// EDGE CASES - WITH LOOPS
// ============================================================================

it("should iterate repeated array with for") {
    let arr = [2; 5];
    let mut product = 1;
    for (x in arr) {
        product = product * x;
    }
    assert(product == 32);
}

it("should iterate repeated array with while") {
    let arr = [3; 4];
    let mut sum = 0;
    let mut i = 0;
    while (i < arr.len()) {
        sum = sum + arr[i];
        i = i + 1;
    }
    assert(sum == 12);
}

// ============================================================================
// EDGE CASES - COMPUTED VALUES
// ============================================================================

it("should repeat function result") {
    fn get_value(): i32 { return 42; }
    let arr = [get_value(); 3];
    assert(arr[0] == 42);
    assert(arr[1] == 42);
    assert(arr[2] == 42);
}

it("should repeat variable expression") {
    let a = 5;
    let b = 3;
    let arr = [a + b; 4];
    assert(arr[0] == 8);
    assert(arr[3] == 8);
}

it("should repeat with variable count") {
    let n = 6;
    let arr = [1; n];
    assert(arr.len() == 6);
}

// ============================================================================
// EDGE CASES - NESTED ARRAYS
// ============================================================================

it("should repeat array of same elements") {
    let inner = [1, 2, 3];
    let outer = [inner; 2];
    assert(outer.len() == 2);
    assert(outer[0][0] == 1);
    assert(outer[1][2] == 3);
}

// ============================================================================
// EDGE CASES - WITH CONDITIONALS
// ============================================================================

it("should use repeated array in condition") {
    let arr = [0; 3];
    if (arr.len() > 0) {
        assert(true);
    } else {
        assert(false);
    }
}

it("should use repeated element in match") {
    let arr = [42; 1];
    let result = match arr[0] {
        42 => "answer",
        _ => "other"
    };
    assert(result == "answer");
}

// ============================================================================
// EDGE CASES - COMPARISONS
// ============================================================================

it("should compare repeated arrays") {
    let a = [5; 3];
    let b = [5; 3];
    assert(a[0] == b[0]);
    assert(a[1] == b[1]);
    assert(a[2] == b[2]);
}

it("should compare lengths of repeated arrays") {
    let a = [1; 5];
    let b = [2; 3];
    assert(a.len() > b.len());
}

// ============================================================================
// EDGE CASES - MODIFICATION
// ============================================================================

it("should modify single element in repeated array") {
    let mut arr = [0; 5];
    arr[2] = 99;
    assert(arr[0] == 0);
    assert(arr[2] == 99);
    assert(arr[4] == 0);
}

it("should push to repeated array") {
    let arr = [1; 3];
    let extended = arr.push(99);
    assert(extended.len() == 4);
    assert(extended[0] == 1);
    assert(extended[3] == 99);
}

it("should concat repeated arrays") {
    let a = [1; 2];
    let b = [2; 2];
    let combined = a.concat(b);
    assert(combined.len() == 4);
    assert(combined[0] == 1);
    assert(combined[2] == 2);
}

// ============================================================================
// EDGE CASES - WITH STRINGS
// ============================================================================

it("should get string length from repeated array") {
    let arr = ["hello"; 3];
    let first = arr[0];
    assert(first.len() == 5);
}

it("should upper string in repeated array") {
    let arr = ["hello"; 2];
    let upper = arr[0].upper();
    assert(upper == "HELLO");
}

