// Test type inference integration with codegen
// This tests that Hindley-Milner type inference works
// and that inferred types are available to the code generator

// Test 1: Simple let binding without type annotation
fn test_simple_inference(): i32 {
    let x = 42;  // Should infer i32
    return x;
}

// Test 2: Function parameter inference
fn add(a: i32, b: i32): i32 {
    let result = a + b;  // Should infer i32
    return result;
}

// Test 3: Array element inference
fn array_ops(): i32 {
    let arr = [1, 2, 3];  // Should infer [i32]
    let first = arr[0];    // Should infer i32
    return first;
}

// Test 4: Conditional inference
fn conditional(): i32 {
    let cond = true;  // Should infer bool
    let value = if cond { 10 } else { 20 };  // Should infer i32
    return value;
}

// Test 5: Let-polymorphism (identity function)
fn identity(x: i32): i32 {
    let id = x;  // Should infer i32
    return id;
}

fn main(): i32 {
    let t1: i32 = test_simple_inference();
    if t1 != 42 {
        return 1;
    }

    let t2: i32 = add(10, 20);
    if t2 != 30 {
        return 2;
    }

    let t3: i32 = array_ops();
    if t3 != 1 {
        return 3;
    }

    let t4: i32 = conditional();
    if t4 != 10 {
        return 4;
    }

    let t5: i32 = identity(99);
    if t5 != 99 {
        return 5;
    }

    print("All type inference tests passed!\n");
    return 0;
}
